WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
[01/29/23 14:29:42] INFO     colossalai - colossalai - INFO:                                                                                           
                             /root/anaconda3/envs/py38/lib/python3.8/site-packages/colossalai/context/parallel_context.py:521 set_device               
[01/29/23 14:29:42] INFO     colossalai - colossalai - INFO:                                                                                           
                             /root/anaconda3/envs/py38/lib/python3.8/site-packages/colossalai/context/parallel_context.py:521 set_device               
                    INFO     colossalai - colossalai - INFO: process rank 1 is bound to device 1                                                       
                    INFO     colossalai - colossalai - INFO: process rank 0 is bound to device 0                                                       
[01/29/23 14:29:45] INFO     colossalai - colossalai - INFO:                                                                                           
                             /root/anaconda3/envs/py38/lib/python3.8/site-packages/colossalai/context/parallel_context.py:557 set_seed                 
[01/29/23 14:29:45] INFO     colossalai - colossalai - INFO:                                                                                           
                             /root/anaconda3/envs/py38/lib/python3.8/site-packages/colossalai/context/parallel_context.py:557 set_seed                 
                    INFO     colossalai - colossalai - INFO: initialized seed on rank 1, numpy: 1024, python random: 1024, ParallelMode.DATA: 1024,    
                             ParallelMode.TENSOR: 1024,the default parallel seed is ParallelMode.DATA.                                                 
                    INFO     colossalai - colossalai - INFO: initialized seed on rank 0, numpy: 1024, python random: 1024, ParallelMode.DATA: 1024,    
                             ParallelMode.TENSOR: 1024,the default parallel seed is ParallelMode.DATA.                                                 
                    INFO     colossalai - colossalai - INFO: /root/anaconda3/envs/py38/lib/python3.8/site-packages/colossalai/initialize.py:117 launch 
                    INFO     colossalai - colossalai - INFO: Distributed environment is initialized, data parallel size: 2, pipeline parallel size: 1, 
                             tensor parallel size: 1                                                                                                   
                    INFO     colossalai - colossalai - INFO: run_clm.py:280 main                                                                       
                    INFO     colossalai - colossalai - INFO: Start preparing dataset                                                                   
Found cached dataset wikitext (/root/.cache/huggingface/datasets/wikitext/wikitext-2-raw-v1/1.0.0/a241db52902eaf2c6aa732210bead40c090019a499ceb13bcbfa3f8ab646a126)
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 428.34it/s]
[01/29/23 14:29:51] INFO     colossalai - colossalai - INFO: run_clm.py:321 main                                                                       
                    INFO     colossalai - colossalai - INFO: Dataset is prepared                                                                       
Found cached dataset wikitext (/root/.cache/huggingface/datasets/wikitext/wikitext-2-raw-v1/1.0.0/a241db52902eaf2c6aa732210bead40c090019a499ceb13bcbfa3f8ab646a126)
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 433.03it/s]
Downloading:   0%|          | 0.00/691 [00:00<?, ?B/s]Downloading: 100%|██████████| 691/691 [00:00<00:00, 342kB/s]
[01/29/23 14:29:53] INFO     colossalai - colossalai - INFO: run_clm.py:337 main                                                                       
                    INFO     colossalai - colossalai - INFO: Model config has been created                                                             
Downloading:   0%|          | 0.00/685 [00:00<?, ?B/s]Downloading: 100%|██████████| 685/685 [00:00<00:00, 372kB/s]
Downloading:   0%|          | 0.00/899k [00:00<?, ?B/s]Downloading:   1%|▏         | 12.3k/899k [00:00<00:17, 49.9kB/s]Downloading:   3%|▎         | 28.7k/899k [00:00<00:14, 59.4kB/s]Downloading:  10%|█         | 90.1k/899k [00:00<00:05, 142kB/s] Downloading:  23%|██▎       | 205k/899k [00:01<00:02, 263kB/s] Downloading:  43%|████▎     | 385k/899k [00:01<00:01, 423kB/s]Downloading:  63%|██████▎   | 565k/899k [00:01<00:00, 504kB/s]Downloading:  87%|████████▋ | 778k/899k [00:01<00:00, 615kB/s]Downloading: 100%|██████████| 899k/899k [00:01<00:00, 499kB/s]
Downloading:   0%|          | 0.00/456k [00:00<?, ?B/s]Downloading:   1%|          | 4.10k/456k [00:00<00:28, 16.1kB/s]Downloading:   7%|▋         | 32.8k/456k [00:00<00:05, 72.7kB/s]Downloading:  22%|██▏       | 98.3k/456k [00:00<00:02, 156kB/s] Downloading:  47%|████▋     | 213k/456k [00:01<00:00, 271kB/s] Downloading:  86%|████████▌ | 393k/456k [00:01<00:00, 404kB/s]Downloading: 100%|██████████| 456k/456k [00:01<00:00, 345kB/s]
Downloading:   0%|          | 0.00/441 [00:00<?, ?B/s]Downloading: 100%|██████████| 441/441 [00:00<00:00, 234kB/s]
[01/29/23 14:30:06] INFO     colossalai - colossalai - INFO: run_clm.py:343 main                                                                       
                    INFO     colossalai - colossalai - INFO: GPT2Tokenizer has been created                                                            
                    INFO     colossalai - colossalai - INFO: run_clm.py:358 main                                                                       
                    INFO     colossalai - colossalai - INFO: Finetune a pre-trained model                                                              
Downloading:   0%|          | 0.00/5.30G [00:00<?, ?B/s]Downloading:   0%|          | 2.05k/5.30G [00:00<174:53:00, 8.42kB/s]Downloading:   0%|          | 34.8k/5.30G [00:00<17:37:12, 83.6kB/s] Downloading:   0%|          | 104k/5.30G [00:00<8:12:17, 180kB/s]   Downloading:   0%|          | 209k/5.30G [00:00<5:12:52, 282kB/s]Downloading:   0%|          | 453k/5.30G [00:01<2:39:37, 554kB/s]Downloading:   0%|          | 939k/5.30G [00:01<1:07:41, 1.31MB/s]Downloading:   0%|          | 1.13M/5.30G [00:01<1:07:44, 1.30MB/s]Downloading:   0%|          | 1.48M/5.30G [00:01<50:08, 1.76MB/s]  Downloading:   0%|          | 1.89M/5.30G [00:01<40:24, 2.19MB/s]Downloading:   0%|          | 2.21M/5.30G [00:01<36:41, 2.41MB/s]Downloading:   0%|          | 3.35M/5.30G [00:01<21:25, 4.12MB/s]Downloading:   0%|          | 4.29M/5.30G [00:02<16:26, 5.37MB/s]Downloading:   0%|          | 4.86M/5.30G [00:02<18:21, 4.81MB/s]Downloading:   0%|          | 6.74M/5.30G [00:02<10:45, 8.20MB/s]Downloading:   0%|          | 7.76M/5.30G [00:02<10:06, 8.73MB/s]Downloading:   0%|          | 8.86M/5.30G [00:02<11:13, 7.86MB/s]Downloading:   0%|          | 10.8M/5.30G [00:02<08:10, 10.8MB/s]Downloading:   0%|          | 12.0M/5.30G [00:02<07:59, 11.0MB/s]Downloading:   0%|          | 13.2M/5.30G [00:02<07:52, 11.2MB/s]Downloading:   0%|          | 14.4M/5.30G [00:02<07:46, 11.3MB/s]Downloading:   0%|          | 15.6M/5.30G [00:03<09:11, 9.60MB/s]Downloading:   0%|          | 17.5M/5.30G [00:03<07:22, 11.9MB/s]Downloading:   0%|          | 18.8M/5.30G [00:03<07:25, 11.9MB/s]Downloading:   0%|          | 20.0M/5.30G [00:03<07:26, 11.8MB/s]Downloading:   0%|          | 21.3M/5.30G [00:03<07:29, 11.8MB/s]Downloading:   0%|          | 22.5M/5.30G [00:03<08:36, 10.2MB/s]Downloading:   0%|          | 24.2M/5.30G [00:03<07:19, 12.0MB/s]Downloading:   0%|          | 25.5M/5.30G [00:03<07:22, 11.9MB/s]Downloading:   1%|          | 26.7M/5.30G [00:04<07:25, 11.8MB/s]Downloading:   1%|          | 27.9M/5.30G [00:04<07:26, 11.8MB/s]Downloading:   1%|          | 29.1M/5.30G [00:04<08:11, 10.7MB/s]Downloading:   1%|          | 30.6M/5.30G [00:04<07:23, 11.9MB/s]Downloading:   1%|          | 31.9M/5.30G [00:04<07:25, 11.8MB/s]Downloading:   1%|          | 33.1M/5.30G [00:04<07:27, 11.8MB/s]Downloading:   1%|          | 34.3M/5.30G [00:04<07:28, 11.8MB/s]Downloading:   1%|          | 35.5M/5.30G [00:04<08:15, 10.6MB/s]Downloading:   1%|          | 37.0M/5.30G [00:04<07:22, 11.9MB/s]Downloading:   1%|          | 38.2M/5.30G [00:05<07:24, 11.9MB/s]Downloading:   1%|          | 39.4M/5.30G [00:05<07:24, 11.8MB/s]Downloading:   1%|          | 40.6M/5.30G [00:05<07:26, 11.8MB/s]Downloading:   1%|          | 41.8M/5.30G [00:05<08:15, 10.6MB/s]Downloading:   1%|          | 43.4M/5.30G [00:05<07:20, 11.9MB/s]Downloading:   1%|          | 44.6M/5.30G [00:05<07:21, 11.9MB/s]Downloading:   1%|          | 45.8M/5.30G [00:05<07:23, 11.8MB/s]Downloading:   1%|          | 47.0M/5.30G [00:05<07:25, 11.8MB/s]Downloading:   1%|          | 48.2M/5.30G [00:05<08:12, 10.7MB/s]Downloading:   1%|          | 49.8M/5.30G [00:06<07:19, 11.9MB/s]Downloading:   1%|          | 51.0M/5.30G [00:06<07:20, 11.9MB/s]Downloading:   1%|          | 52.2M/5.30G [00:06<07:22, 11.9MB/s]Downloading:   1%|          | 53.4M/5.30G [00:06<08:51, 9.88MB/s]Downloading:   1%|          | 55.3M/5.30G [00:06<07:08, 12.3MB/s]Downloading:   1%|          | 56.7M/5.30G [00:06<07:14, 12.1MB/s]Downloading:   1%|          | 57.9M/5.30G [00:06<07:17, 12.0MB/s]Downloading:   1%|          | 59.2M/5.30G [00:06<07:19, 11.9MB/s]Downloading:   1%|          | 60.4M/5.30G [00:06<08:40, 10.1MB/s]